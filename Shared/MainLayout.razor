@inherits LayoutComponentBase
@inject HttpClient  Http

<NavMenu />
@if (Cars != null)
{
    <CascadingValue Value="this">
        <CascadingValue Value="@Cars">
            <div class="content">
                @Body
            </div>
        </CascadingValue>
    </CascadingValue>

}
<InfoFooter />

@functions {
    private Car[] Cars;
    internal SortMethod SortedMethod;

    protected override async Task OnInitAsync()
    {
        Cars = await Http.GetJsonAsync<Car[]>(Constants.JsonPath);
        SortCars(SortMethod.HighestPrice);
    }

    internal void SortCars(SortMethod method)
    {
        SortedMethod = method;
        switch (method)
        {
            case SortMethod.HighestPrice:
                Cars = Cars.OrderByDescending(car => car.Price).ToArray();
                break;
            case SortMethod.LowestPrice:
                Cars = Cars.OrderBy(car => car.Price).ToArray();
                break;
            case SortMethod.HighestMileage:
                Cars = Cars.OrderByDescending(car => car.Mileage).ToArray();
                break;
            case SortMethod.LowestMileage:
                Cars = Cars.OrderBy(car => car.Mileage).ToArray();
                break;

        }
        StateHasChanged();
    }
}
